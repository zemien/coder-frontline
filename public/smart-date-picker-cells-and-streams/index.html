<!DOCTYPE html>
<html lang="en-nz">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta itemprop="name" content="Smart Date Picker: Cells and Streams">
<meta itemprop="description" content="I covered the requirements of the smart date picker in my last post, which ended with a data flow diagram. Today I aim to translate that conceptual view to primitives within Sodium, a functional reactive programming (FRP) library supported on multiple languages. The only types in Sodium are Cells and Streams. I will attempt to provide a brief explanation."><meta itemprop="datePublished" content="2016-07-10T13:43:58&#43;12:00" />
<meta itemprop="dateModified" content="2016-07-10T13:43:58&#43;12:00" />
<meta itemprop="wordCount" content="1018">
<meta itemprop="keywords" content="" /><meta property="og:title" content="Smart Date Picker: Cells and Streams" />
<meta property="og:description" content="I covered the requirements of the smart date picker in my last post, which ended with a data flow diagram. Today I aim to translate that conceptual view to primitives within Sodium, a functional reactive programming (FRP) library supported on multiple languages. The only types in Sodium are Cells and Streams. I will attempt to provide a brief explanation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/smart-date-picker-cells-and-streams/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-07-10T13:43:58&#43;12:00" />
<meta property="article:modified_time" content="2016-07-10T13:43:58&#43;12:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Smart Date Picker: Cells and Streams"/>
<meta name="twitter:description" content="I covered the requirements of the smart date picker in my last post, which ended with a data flow diagram. Today I aim to translate that conceptual view to primitives within Sodium, a functional reactive programming (FRP) library supported on multiple languages. The only types in Sodium are Cells and Streams. I will attempt to provide a brief explanation."/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Smart Date Picker: Cells and Streams</title>
	<link rel="stylesheet" href="/css/style.min.f74778e3020c87c304fb5982e09b92ba63a5c7f202996d4c7283d6057acfe9c1.css" integrity="sha256-90d44wIMh8ME+1mC4JuSumOlx/ICmW1McoPWBXrP6cE=" crossorigin="anonymous">
	<style>.bg-img {background-image: url('/wp-content/uploads/sites/2/2016/06/outsidein-layered-reflected-connected-henk-sijgers.jpg');}</style>
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="/">Coder Frontline</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="/posts/">Posts</a>
				<a href="/categories/">Categories</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="img-btn" class="hdr-btn" title="Featured Image"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-image"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg></button><span class="hdr-social hide-in-mobile"><a href="https://www.linkedin.com/in/shawnlamnz" target="_blank" rel="noopener me" title="Linkedin"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="https://github.com/zemien" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="/posts/">Posts</a></li>
			<li><a href="/categories/">Categories</a></li>
		</ul>
	</div>


	<div class="bg-img"></div>
	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Jul 10, 2016</span></div>
				<h1>Smart Date Picker: Cells and Streams</h1>
			</header>
			<div class="content">
				<p>I covered the <a href="/smart-date-picker-requirements/">requirements of the smart date picker</a> in my last post, which ended with a data flow diagram. Today I aim to translate that conceptual view to primitives within <a href="https://github.com/SodiumFRP/sodium">Sodium, a functional reactive programming (FRP) library</a> supported on multiple languages. The only types in Sodium are Cells and Streams. I will attempt to provide a brief explanation.</p>
<h2 id="cells">Cells<a href="#cells" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>In essence, a Cell is a value that changes over time. Specifically, it is a generic type Cell<T> that can contain almost any type you specify. Other FRP systems might call it a Behavior, Property or a Signal.</p>
<p>The reason Sodium calls it a Cell is because it is conceptually similar to a cell in a spreadsheet. Individual cells in a spreadsheet contain a value but they are not constant. They can change over time, especially in response to changes in other parts of the workbook. Let me illustrate that with Excel’s personal budget template:</p>
<p><img class="alignnone wp-image-187 size-large" src="/wp-content/uploads/sites/2/2016/07/personal-budget-template-1.png" alt="personal-budget-template-1" width="640" height="439" srcset="/wp-content/uploads/sites/2/2016/07/personal-budget-template-1.png 1024w, /wp-content/uploads/sites/2/2016/07/personal-budget-template-1.png 300w, /wp-content/uploads/sites/2/2016/07/personal-budget-template-1.png 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>This is a simple template where you can put in your income, expenses, and savings. It then shows you a summary for the month with a chart and totals. Let’s trace the precedents and dependents of the Total Monthly Income cell:</p>
<p><img class="alignnone size-large wp-image-188" src="/wp-content/uploads/sites/2/2016/07/personal-budget-template-2.png" alt="personal-budget-template-2" width="640" height="446" srcset="/wp-content/uploads/sites/2/2016/07/personal-budget-template-2.png 1024w, /wp-content/uploads/sites/2/2016/07/personal-budget-template-2.png 300w, /wp-content/uploads/sites/2/2016/07/personal-budget-template-2.png 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>It is straightforward. Total Monthly Income is a <strong>function</strong> that sums up all income sources, and its result is in turn used by the Cash Balance cell to determine how much extra you have left in your bank account. It is also used by the chart data to construct a delicious pie chart. See what happend when I add a new line of income:</p>
<p><img class="alignnone size-large wp-image-189" src="/wp-content/uploads/sites/2/2016/07/personal-budget-template-3.png" alt="personal-budget-template-3" width="640" height="451" srcset="/wp-content/uploads/sites/2/2016/07/personal-budget-template-3.png 1024w, /wp-content/uploads/sites/2/2016/07/personal-budget-template-3.png 300w, /wp-content/uploads/sites/2/2016/07/personal-budget-template-3.png 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>When I do that, the Total Monthly Income, Cash Balance, and pie chart are all updated <strong>simultaneously</strong>. There is no need to manually recalculate because Excel knows the <strong>dependency</strong> between the cells and so knows the correct order to update them.</p>
<p>This brings us to the concept of Streams.</p>
<h2 id="streams">Streams<a href="#streams" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>A Stream<T> in the world of Sodium represents a “stream of events”. A single mouse click on a button is an event, but multiple mouse clicks on the button throughout the program life cycle would be represented by a stream of mouse clicks.</p>
<p>I find it easiest to think of a Stream as an event handler/listener. I’m sure there are differences between them but I view it as a functional event handler that plugs in to the rest of the Sodium framework. Realistically, one would provide a function that executes when the specified stream fires. This is no different from writing an event handler method but with the added ability to work with Cells and other Sodium primitive operations.</p>
<p>I believe it is called a Stream like the body of water that continuously meanders across the earth. Similarly, a Stream<T> event flows through the program and creates a ripple of changes. In the spreadsheet example above it is logical to conceive of my user input as a stream that leads to other cells being updated.</p>
<h2 id="smart-date-picker">Smart Date Picker<a href="#smart-date-picker" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>So what are the Cells and Streams of the smart date picker I am trying to implement? I would look at the data flow diagram I created last week and ponder upon what values are being held and what sources of events are present.</p>
<p><img class="size-large wp-image-177" src="/wp-content/uploads/sites/2/2016/07/Smart-Date-Picker-Data-Flow.png" alt="Smart Date Picker Data Flow Diagram" width="640" height="564" srcset="/wp-content/uploads/sites/2/2016/07/Smart-Date-Picker-Data-Flow.png 1024w, /wp-content/uploads/sites/2/2016/07/Smart-Date-Picker-Data-Flow.png 300w, /wp-content/uploads/sites/2/2016/07/Smart-Date-Picker-Data-Flow.png 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>At a theoretical level, I think they would be:</p>
<p>Cells:</p>
<ul>
<li>Data Availability Dates</li>
<li>Period Type (whether it is Weeks, Months, or Quarters)</li>
<li>Date Range (the selected start and end date for the report)</li>
</ul>
<p>Streams:</p>
<ul>
<li>Select Weeks</li>
<li>Select Months</li>
<li>Select Quarters</li>
<li>Select Start Date</li>
<li>Select End Date</li>
</ul>
<p>You might have noticed a few omissions in my cells and streams. I did not put Start Date and End Date as a Cell because ultimately the date pickers are only sources of events. Whatever the user picks are merely a suggestion. The date bumping logic still needs to decide if it is valid, which then updates the date picker and the Date Range cell with the final outcome.</p>
<p>Changes in Data Availability Dates might resemble a Stream, but I did not model it as one because the changes are initiated from outside the application, i.e. database updates. There is a strict requirement of <strong>referential transparency</strong> in Sodium, which means:</p>
<ul>
<li>you must not perform any I/O;</li>
<li>you must not throw any exceptions unless they are caught and handled within the  function;</li>
<li>you must not read the value of any external variable if its value can change, but  constants are allowed and encouraged;</li>
<li>you must not modify any externally visible state;</li>
<li>you must not keep any state between invocations of the function;</li>
</ul>
<p>(The above list is excerpted from the <a href="https://www.manning.com/books/functional-reactive-programming">book Functional Reactive Programming</a>)</p>
<p>Because checking the Data Availability Dates would require I/O (query the DB), it needs to be done outside of FRP. I know you’re asking: How would one integrate FRP into an application that needs to do I/O and throw exceptions? That is a question I have often asked myself as I read the book but the authors insist on keeping those details under wraps until halfway through the book in Chapter 8. This is done under the guise of keeping the reader’s mind ‘pure’ in FRP-Land before the messy reality of integration hits. I have not formed an opinion regarding this approach yet as I’m still reading the book, but will return to this later.</p>
<p>My list of cells and streams for the smart date picker might change as I start implementing it and discover better ways of looking at the problem. Next week: I will write about some of the operational primitives I may need in Sodium to transform cells and streams from one form to another.</p>
<p><em>This is part of an ongoing series where I review the book</em><a href="https://www.manning.com/books/functional-reactive-programming"> <em>Functional Reactive Programming by Stephen Blackheath and Anthony Jones</em></a><em>. Kindly note that anything I write here may be incorrect and not indicative of the author’s intent. After all, making mistakes is the mother of learning and this book review is meant to be a truthful reflection of my own experiences grasping a new concept. The review copy I received was version 11 in their Manning’s Early Access Program, so the book’s contents may differ at the time of publication.</em></p>
			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>1018 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2016-07-10 13:43 &#43;1200</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="/smart-date-picker-changing-the-period-type-using-frp-primitives/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>Smart Date Picker: Changing the period type using FRP Primitives</span>
			</a>
			<a class="prev-post" href="/smart-date-picker-requirements-and-test-cases/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Smart Date Picker: Requirements and Test Cases</span>
			</a>
		</div>
		<div id="comments" class="thin">
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2021 <a href="/">Shawn Lam</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>



	<script src="/js/bundle.min.7d8545daa55d62427355498dd8da13f98ff79a7938ce7d2a5e2ae1ec0de3beb8.js" integrity="sha256-fYVF2qVdYkJzVUmN2NoT+Y/3mnk4zn0qXirh7A3jvrg=" crossorigin="anonymous"></script>
	
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-74441668-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
